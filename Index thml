<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Samsung Dual Audio - HTTPS Setup</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #f0f2f5; font-family: 'SamsungSans', 'Segoe UI', sans-serif; }
        .oneui-card { border-radius: 24px; background: white; box-shadow: 0 4px 20px rgba(0,0,0,0.05); }
        .step-badge { @apply w-8 h-8 rounded-full bg-blue-600 text-white flex items-center justify-center font-bold; }
    </style>
</head>
<body class="p-4 flex justify-center pb-12">

    <div class="w-full max-w-md space-y-6">
        <!-- Header -->
        <div class="mt-6 px-4">
            <h1 class="text-3xl font-black text-gray-900">Activar HTTPS</h1>
            <p class="text-gray-500 mt-2">El Bluetooth requiere una conexión segura para funcionar.</p>
        </div>

        <!-- AI Assistant: Guía HTTPS -->
        <div class="oneui-card p-6 border-l-4 border-blue-600 bg-blue-50/30">
            <div class="flex items-center gap-2 mb-4">
                <span class="text-blue-600">✨</span>
                <h2 class="font-bold text-blue-900 uppercase text-xs tracking-widest">Asistente Gemini</h2>
            </div>
            <p id="aiGuidance" class="text-sm text-blue-800 leading-relaxed">
                Detecto que estás intentando ejecutar la app en un entorno de pruebas. Para usar el Bluetooth real, sigue los pasos de abajo para obtener un enlace HTTPS gratuito.
            </p>
        </div>

        <!-- Steps to HTTPS -->
        <div class="space-y-4">
            <div class="oneui-card p-5 flex gap-4 items-start">
                <div class="step-badge">1</div>
                <div>
                    <h3 class="font-bold text-gray-800">Copia el código</h3>
                    <p class="text-xs text-gray-500 mt-1">Haz clic en el botón de copiar en la esquina superior de este editor.</p>
                </div>
            </div>

            <div class="oneui-card p-5 flex gap-4 items-start">
                <div class="step-badge">2</div>
                <div>
                    <h3 class="font-bold text-gray-800">Usa "GitHub Gist" o "CodePen"</h3>
                    <p class="text-xs text-gray-500 mt-1">Son plataformas gratuitas que sirven tu código bajo HTTPS automáticamente.</p>
                </div>
            </div>

            <div class="oneui-card p-5 flex gap-4 items-start border-2 border-dashed border-blue-200">
                <div class="step-badge bg-green-500">3</div>
                <div class="w-full">
                    <h3 class="font-bold text-gray-800">Verifica el candado</h3>
                    <p class="text-xs text-gray-500 mt-1">Asegúrate de que la URL empiece por <span class="text-green-600 font-mono">https://</span>.</p>
                </div>
            </div>
        </div>

        <!-- Diagnostic Tools -->
        <div class="oneui-card p-6">
            <h3 class="font-bold text-gray-800 mb-4">Estado del Entorno</h3>
            <div class="space-y-3">
                <div class="flex justify-between text-sm">
                    <span class="text-gray-500">Protocolo seguro (HTTPS)</span>
                    <span id="statHttps" class="font-bold">Verificando...</span>
                </div>
                <div class="flex justify-between text-sm">
                    <span class="text-gray-500">Permiso de Bluetooth</span>
                    <span id="statBt" class="font-bold">Verificando...</span>
                </div>
                <div class="flex justify-between text-sm">
                    <span class="text-gray-500">Navegador compatible</span>
                    <span id="statBrowser" class="font-bold">Verificando...</span>
                </div>
            </div>
            <button onclick="askAIFix()" class="w-full mt-6 bg-gray-900 text-white font-bold py-3 rounded-2xl text-sm">
                Consultar Solución con IA
            </button>
        </div>

        <div id="aiResponseBox" class="oneui-card p-5 bg-black text-white hidden">
            <p id="aiResponseText" class="text-xs font-mono leading-relaxed"></p>
        </div>
    </div>

    <script>
        const apiKey = "";

        window.onload = () => {
            const isHttps = location.protocol === 'https:';
            const hasBt = 'bluetooth' in navigator;
            const isChrome = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);

            document.getElementById('statHttps').innerText = isHttps ? "✅ SÍ" : "❌ NO";
            document.getElementById('statHttps').className = isHttps ? "text-green-600 font-bold" : "text-red-600 font-bold";
            
            document.getElementById('statBt').innerText = hasBt ? "✅ LISTO" : "❌ BLOQUEADO";
            document.getElementById('statBt').className = hasBt ? "text-green-600 font-bold" : "text-red-600 font-bold";

            document.getElementById('statBrowser').innerText = isChrome ? "✅ OK" : "⚠️ RECOMENDADO CHROME";
        };

        async function askAIFix() {
            const box = document.getElementById('aiResponseBox');
            const txt = document.getElementById('aiResponseText');
            box.classList.remove('hidden');
            txt.innerText = "> Analizando configuración actual...\n> Consultando Gemini API...";

            const prompt = `El usuario tiene estos datos: HTTPS=${location.protocol === 'https:'}, Bluetooth=${'bluetooth' in navigator}. Explícale brevemente por qué el Bluetooth no funciona en un IFRAME de desarrollo y cómo puede usar 'GitHub Pages' para ponerlo en HTTPS gratis.`;
            
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: prompt }] }],
                        systemInstruction: { parts: [{ text: "Eres un consultor técnico experto en despliegue web." }] }
                    })
                });
                const data = await response.json();
                txt.innerText = data.candidates[0].content.parts[0].text;
            } catch (e) {
                txt.innerText = "Error al conectar con la IA. Asegúrate de copiar el código en un sitio HTTPS como GitHub Pages.";
            }
        }
    </script>
</body>
</html>
